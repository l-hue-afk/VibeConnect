<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VibeConnect - Anonymous Chat</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        :root { /* Styles for a pretty, cool design */
            --primary-color: #6a0572; /* Deep Purple */
            --secondary-color: #ab3a9f; /* Lighter Purple */
            --accent-color: #ff9f1c; /* Orange Accent */
            --bg-dark: #2c0032; 
            --bg-light: #ffffff; 
            --text-light: #f4f4f4;
            --shadow-dark: 0 10px 30px rgba(0, 0, 0, 0.2);
        }
        body { font-family: 'Poppins', sans-serif; background: linear-gradient(135deg, var(--bg-dark) 0%, var(--primary-color) 100%); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; color: #333; overflow: hidden; position: relative; }
        .chat-container { width: 90%; max-width: 450px; background: var(--bg-light); border-radius: 15px; box-shadow: var(--shadow-dark); overflow: hidden; z-index: 1; display: flex; flex-direction: column; min-height: 500px; max-height: 80vh; position: relative; }
        .chat-header { background: var(--primary-color); color: var(--text-light); padding: 15px 20px; font-weight: 600; font-size: 1.2em; text-align: center; }
        #status { text-align: center; padding: 10px; background: var(--accent-color); color: var(--text-light); font-weight: 400; font-size: 0.9em; }
        #messages { flex-grow: 1; overflow-y: auto; padding: 15px; list-style: none; margin: 0; background: #fdfdfd; border-bottom: 1px solid #e0e0e0; }
        #messages li { margin-bottom: 10px; padding: 10px 15px; border-radius: 20px; max-width: 75%; }
        .my-msg { background: var(--secondary-color); color: var(--text-light); margin-left: auto; border-bottom-right-radius: 5px; }
        .partner-msg { background: #e9ebee; color: #333; margin-right: auto; border-bottom-left-radius: 5px; }
        #controls { padding: 15px; display: flex; flex-direction: column; align-items: center; gap: 10px; background: var(--bg-light); border-top: 1px solid #e0e0e0; }
        button { width: 100%; padding: 12px 20px; border: none; border-radius: 8px; font-size: 1em; font-weight: 600; cursor: pointer; transition: background-color 0.3s ease; }
        #start-button { background: var(--primary-color); color: var(--text-light); }
        #message-form { padding: 15px; display: flex; gap: 10px; background: var(--bg-light); border-top: 1px solid #e0e0e0; }
        #m { flex-grow: 1; padding: 10px 15px; border: 1px solid #e0e0e0; border-radius: 25px; outline: none; }
        #message-form button { width: auto; padding: 10px 20px; background-color: var(--accent-color); color: white; border-radius: 25px; flex-shrink: 0; }
        
        /* AUTH WALL & PAYWALL STYLES */
        #auth-wall, #paywall { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255, 255, 255, 0.98); z-index: 20; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; text-align: center; border-radius: 15px; }
        .google-btn { background: #4285F4; color: white; width: 80%; max-width: 300px; }
        #paywall input, #paywall button { width: 80%; max-width: 300px; margin-top: 10px; }
    </style>
    
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-auth.js"></script>
    <script src="/socket.io/socket.io.js"></script>
</head>
<body>
    <div class="background-dots"><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div><div class="dot"></div></div>

    <div class="chat-container">
        <div id="auth-wall" style="display: flex;">
            <h2>VibeConnect</h2>
            <p>Log in to access your exclusive college chat.</p>
            <button id="google-login-btn" class="google-btn"><i class="fab fa-google"></i> Sign in with Google</button>
            <p style="margin-top: 10px; font-size: 0.8em;">Secure login. We don't share your name.</p>
        </div>

        <div id="paywall" style="display: none;">
            <h2>Subscription Required - ₹10/month</h2>
            <p>Please pay ₹10 to activate 30 days of access.</p>
            <a id="upi-pay-link" href="upi://pay?pa=7976167098@axl&am=10&cu=INR&pn=VibeConnect%20Subscription" 
               target="_blank" style="text-decoration: none; width: 80%; max-width: 300px;">
                <button style="background-color: #28a745; margin-bottom: 15px;"><i class="fas fa-wallet"></i> Pay ₹10 Now (via UPI)</button>
            </a>
            <p style="margin-top: 15px;">After paying, enter your **UPI Transaction ID** (Ref No.) below:</p>
            <input type="text" id="tx-id-input" placeholder="Enter Transaction ID (Ref No.)" required>
            <button id="submit-tx-id">Submit for Verification</button>
            <p id="tx-status-msg" style="color: #dc3545; font-size: 0.9em; margin-top: 10px;"></p>
        </div>
        
        <div class="chat-header">VibeConnect <i class="fas fa-comments"></i></div>
        <div id="status" class="info">Initializing...</div>
        <ul id="messages"></ul>
        <div id="controls"><button id="start-button" disabled>Start Chat</button></div>
        <form id="message-form" style="display: none;"><input id="m" autocomplete="off" placeholder="Type message..." /><button><i class="fas fa-paper-plane"></i></button></form>
    </div>
    <script src="script.js"></script>
</body>
</html>